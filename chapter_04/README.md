# Chapter 04. 좋은 단위 테스트의 4대 요소
- - -

## 좋은 단위 테스트의 4대 요소 
* 회귀 방지
* 리팩터링 내성
* 빠른 피드백
* 유지 보수성 

### 회귀 방지
* 회귀는 소프트웨어 버그다. 코드를 수정한 후 기능이 의도한 대로 작동하지 않는 경우다.
* 회귀 방지 지표에 대한 테스트 점수가 얼마나 잘 나오는지 평가하려면 다음 사항을 고려해야 한다.
  * 테스트 중에 실행되는 코드의 양
  * 코드 복잡도
  * 코드의 도메인 유의성
* 일반적으로 실행되는 코드가 많을수록 테스트에서 회귀가 나타날 가능성이 높다.
  * 코드가 예외를 발생시키지 않고 실행된다는 것을 아는 데 도움은 되지만, 코드가 생성하는 결과가 유효한지도 확인해야 한다.
* 단순한 코드를 테스트하는 것은 가치가 없다.
* 회귀 방지 지표를 극대화하려면 테스트가 가능한 한 많은 코드를 실행하는 것을 목표로 해야 한다.

### 리팩터링 내성
* 테스트를 빨간색(실패)으로 바꾸지 않고 기본 애플리케이션 코드를 리팩터링할 수 있는지에 대한 척도다.
* 리팩터링은 식별할 수 있는 동작을 수정하지 않고 기존 코드를 변경하는 것이다.
  * 코드의 비기능적인 특징을 개선하여 가독성을 높이고 복잡도를 낮추기 위함이다.
* 테스트가 지속 가능한 성장을 하게 하는 메커니즘은 회귀 없이 주기적으로 리팩터링하고 새로운 기능을 추가할 수 있는 것이다. 이는 두 가지 장점이 존재한다.
  * 기존 기능이 고장 났을 때 테스트가 조기 경고를 제공한다.
  * 코드 변경이 회귀로 이어지지 않을 것이라고 확신할 수 있다.
* 실제로 기능이 의도한 대로 작동하지만 테스트는 실패하는 경우를 거짓 양성이라고 한다.
  * 거짓 양성은 테스트 스위트에 대한 신뢰를 떨어지게 한다.

### 거짓 양성의 원인
* 테스트와 테스트 대상 시스템의 구현 세부 사항이 많이 결합할수록 허위 경보가 더 많이 생긴다.
* 거짓 양성이 생길 가능성을 줄이는 방법은 해당 구현 세부 사항에서 테스트를 분리하는 것뿐이다.
  * 테스트가 SUT가 생성한 결과가 아니라 SUT의 세부 구현 사항과 결합하지 않도록 한다.
  * 테스트가 똑같이 적용할 수 있는 다른 구현을 고려하지 않고 특정 구현만 예상해서 알고리즘을 검사하지 않도록 해야 한다.
